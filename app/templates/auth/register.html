{% extends 'base/base.html' %}
{% block title %}Sign in | SEIT KMITL{% endblock %}
{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/register.css') }}">
<section class="auth">
  <h1 class="auth__heading">sign in</h1>

  <div class="auth__card">
    <form class="auth__form" method="post" action="{{ url_for('auth.register_action') }}">
      {% if error %}<div class="auth__alert auth__alert--error">{{ error }}</div>{% endif %}
      {% if success %}<div class="auth__alert auth__alert--success">р╕кр╕бр╕▒р╕Др╕гр╕кр╕бр╕▓р╕Кр╕┤р╕Бр╕кр╕│р╣Ар╕гр╣Зр╕И!</div>{% endif %}

      <div class="auth__grid">
        <div class="auth__field auth__field--full">
          <label class="auth__label">р╕Кр╕╖р╣Ир╕нтАУр╕Щр╕▓р╕бр╕кр╕Бр╕╕р╕е</label>
          <input class="auth__input" type="text" name="name" value="{{ old.name if old else '' }}" required>
        </div>

        <div class="auth__field auth__field--full">
          <label class="auth__label">р╕гр╕лр╕▒р╕кр╕Ыр╕гр╕░р╕Ир╕│р╕Хр╕▒р╕з</label>
          <input class="auth__input" type="text" name="student_id" value="{{ old.student_id if old else '' }}" required>
        </div>

        <div class="auth__field">
          <label class="auth__label">р╣Ар╕Юр╕и</label>
          <select class="auth__input" name="gender" required>
            <option value="">р╣Ар╕ер╕╖р╕нр╕Бр╣Ар╕Юр╕и</option>
            <option value="male"   {% if old and old.gender=='male' %}selected{% endif %}>р╕Кр╕▓р╕в</option>
            <option value="female" {% if old and old.gender=='female' %}selected{% endif %}>р╕лр╕Нр╕┤р╕З</option>
            <option value="other"  {% if old and old.gender=='other' %}selected{% endif %}>р╕нр╕╖р╣Ир╕Щ р╣Ж</option>
          </select>
        </div>

        <div class="auth__field">
          <label class="auth__label">р╕Ыр╕гр╕░р╣Ар╕ар╕Чр╕кр╕бр╕▓р╕Кр╕┤р╕Б</label>
          <select class="auth__input" name="member_type" required>
            <option value="">р╣Ар╕ер╕╖р╕нр╕Бр╕Ыр╕гр╕░р╣Ар╕ар╕Чр╕кр╕бр╕▓р╕Кр╕┤р╕Б</option>
            <option value="student" {% if old and old.member_type=='student' %}selected{% endif %}>р╕Щр╕▒р╕Бр╕ир╕╢р╕Бр╕йр╕▓</option>
            <option value="teacher" {% if old and old.member_type=='teacher' %}selected{% endif %}>р╕нр╕▓р╕Ир╕▓р╕гр╕вр╣М</option>
            <option value="staff"   {% if old and old.member_type=='staff' %}selected{% endif %}>р╣Ар╕Ир╣Йр╕▓р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣И</option>
          </select>
        </div>

 <div class="auth__field auth__field--full">
  <label class="auth__label">р╕кр╕▓р╕Вр╕▓р╕зр╕┤р╕Кр╕▓</label>
  <select class="auth__input" name="major" required>
    <option value="">р╕Бр╕гр╕╕р╕Ур╕▓р╣Ар╕ер╕╖р╕нр╕Бр╕кр╕▓р╕Вр╕▓</option>

    <optgroup label="р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╕кр╕Цр╕▓р╕Ыр╕▒р╕Хр╕вр╕Бр╕гр╕гр╕б">
      <option value="р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╕кр╕Цр╕▓р╕Ыр╕▒р╕Хр╕вр╕Бр╕гр╕гр╕б">р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╕кр╕Цр╕▓р╕Ыр╕▒р╕Хр╕вр╕Бр╕гр╕гр╕б</option>
      <option value="р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╕Бр╕▓р╕гр╕нр╕нр╕Бр╣Бр╕Ър╕Ъ (р╕лр╕ер╕▒р╕Бр╕кр╕╣р╕Хр╕г 5 р╕Ыр╕╡)">р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╕Бр╕▓р╕гр╕нр╕нр╕Бр╣Бр╕Ър╕Ъ (р╕лр╕ер╕▒р╕Бр╕кр╕╣р╕Хр╕г 5 р╕Ыр╕╡)</option>
      <option value="р╕кр╕Цр╕▓р╕Ыр╕▒р╕Хр╕вр╕Бр╕гр╕гр╕б (р╕лр╕ер╕▒р╕Бр╕кр╕╣р╕Хр╕г 5 р╕Ыр╕╡)">р╕кр╕Цр╕▓р╕Ыр╕▒р╕Хр╕вр╕Бр╕гр╕гр╕б (р╕лр╕ер╕▒р╕Бр╕кр╕╣р╕Хр╕г 5 р╕Ыр╕╡)</option>
      <option value="р╕Бр╕▓р╕гр╕нр╕нр╕Бр╣Бр╕Ър╕Ър╕кр╕ар╕▓р╕Юр╣Бр╕зр╕Фр╕ер╣Йр╕нр╕бр╕ар╕▓р╕вр╣Гр╕Щ (р╕лр╕ер╕▒р╕Бр╕кр╕╣р╕Хр╕г 5 р╕Ыр╕╡)">р╕Бр╕▓р╕гр╕нр╕нр╕Бр╣Бр╕Ър╕Ър╕кр╕ар╕▓р╕Юр╣Бр╕зр╕Фр╕ер╣Йр╕нр╕бр╕ар╕▓р╕вр╣Гр╕Щ (р╕лр╕ер╕▒р╕Бр╕кр╕╣р╕Хр╕г 5 р╕Ыр╕╡)</option>
      <option value="р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╕Бр╕▓р╕гр╕нр╕нр╕Бр╣Бр╕Ър╕Ъ (р╕лр╕ер╕▒р╕Бр╕кр╕╣р╕Хр╕г 4 р╕Ыр╕╡)">р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╕Бр╕▓р╕гр╕нр╕нр╕Бр╣Бр╕Ър╕Ъ (р╕лр╕ер╕▒р╕Бр╕кр╕╣р╕Хр╕г 4 р╕Ыр╕╡)</option>
      <option value="р╕Щр╕зр╕▒р╕Хр╕Бр╕гр╕гр╕бр╣Бр╕ер╕░р╣Ар╕Чр╕Др╣Вр╕Щр╣Вр╕ер╕вр╕╡р╕Бр╕▓р╕гр╕нр╕нр╕Бр╣Бр╕Ър╕Ъ">р╕Щр╕зр╕▒р╕Хр╕Бр╕гр╕гр╕бр╣Бр╕ер╕░р╣Ар╕Чр╕Др╣Вр╕Щр╣Вр╕ер╕вр╕╡р╕Бр╕▓р╕гр╕нр╕нр╕Бр╣Бр╕Ър╕Ъ</option>
    </optgroup>

    <optgroup label="р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╕нр╕╕р╕Хр╕кр╕▓р╕лр╕Бр╕гр╕гр╕б">
      <option value="р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╕нр╕╕р╕Хр╕кр╕▓р╕лр╕Бр╕гр╕гр╕б">р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╕нр╕╕р╕Хр╕кр╕▓р╕лр╕Бр╕гр╕гр╕б</option>
      <option value="р╕зр╕┤р╕Чр╕вр╕▓р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Щр╕гр╕╣р╣Й">р╕зр╕┤р╕Чр╕вр╕▓р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Щр╕гр╕╣р╣Й</option>
    </optgroup>

    <optgroup label="р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╕зр╕┤р╕ир╕зр╕Бр╕гр╕гр╕б">
      <option value="р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╕зр╕┤р╕ир╕зр╕Бр╕гр╕гр╕б">р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╕зр╕┤р╕ир╕зр╕Бр╕гр╕гр╕б</option>
      <option value="р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╕зр╕┤р╕ир╕зр╕Бр╕гр╕гр╕б (р╕лр╕ер╕▒р╕Бр╕кр╕╣р╕Хр╕г 5 р╕Ыр╕╡)">р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╕зр╕┤р╕ир╕зр╕Бр╕гр╕гр╕б (р╕лр╕ер╕▒р╕Бр╕кр╕╣р╕Хр╕г 5 р╕Ыр╕╡)</option>
      <option value="р╣Ар╕Чр╕Др╣Вр╕Щр╣Вр╕ер╕вр╕╡р╕нр╕┤р╣Ар╕ер╣Зр╕Бр╕Чр╕гр╕нр╕Щр╕┤р╕Бр╕кр╣М (р╕Хр╣Ир╕нр╣Ар╕Щр╕╖р╣Ир╕нр╕З)">р╣Ар╕Чр╕Др╣Вр╕Щр╣Вр╕ер╕вр╕╡р╕нр╕┤р╣Ар╕ер╣Зр╕Бр╕Чр╕гр╕нр╕Щр╕┤р╕Бр╕кр╣М (р╕Хр╣Ир╕нр╣Ар╕Щр╕╖р╣Ир╕нр╕З)</option>
      <option value="р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╕зр╕┤р╕ир╕зр╕Бр╕гр╕гр╕б (р╕лр╕ер╕▒р╕Бр╕кр╕╣р╕Хр╕г 4 р╕Ыр╕╡)">р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╕зр╕┤р╕ир╕зр╕Бр╕гр╕гр╕б (р╕лр╕ер╕▒р╕Бр╕кр╕╣р╕Хр╕г 4 р╕Ыр╕╡)</option>
      <option value="р╣Ар╕Чр╕Др╣Вр╕Щр╣Вр╕ер╕вр╕╡р╕Др╕нр╕бр╕Юр╕┤р╕зр╣Ар╕Хр╕нр╕гр╣М">р╣Ар╕Чр╕Др╣Вр╕Щр╣Вр╕ер╕вр╕╡р╕Др╕нр╕бр╕Юр╕┤р╕зр╣Ар╕Хр╕нр╕гр╣М</option>
      <option value="р╕нр╕┤р╣Ар╕ер╣Зр╕Бр╕Чр╕гр╕нр╕Щр╕┤р╕Бр╕кр╣Мр╣Бр╕ер╕░р╣Вр╕Чр╕гр╕Др╕бр╕Щр╕▓р╕Др╕б">р╕нр╕┤р╣Ар╕ер╣Зр╕Бр╕Чр╕гр╕нр╕Щр╕┤р╕Бр╕кр╣Мр╣Бр╕ер╕░р╣Вр╕Чр╕гр╕Др╕бр╕Щр╕▓р╕Др╕б</option>
    </optgroup>

    <optgroup label="р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╣Ар╕Бр╕йр╕Хр╕г">
      <option value="р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╣Ар╕Бр╕йр╕Хр╕г">р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╣Ар╕Бр╕йр╕Хр╕г</option>
      <option value="р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╣Ар╕Бр╕йр╕Хр╕г (р╕лр╕ер╕▒р╕Бр╕кр╕╣р╕Хр╕г 5 р╕Ыр╕╡)">р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╣Ар╕Бр╕йр╕Хр╕г (р╕лр╕ер╕▒р╕Бр╕кр╕╣р╕Хр╕г 5 р╕Ыр╕╡)</option>
      <option value="р╣Ар╕Чр╕Др╣Вр╕Щр╣Вр╕ер╕вр╕╡р╕Кр╕╡р╕зр╕ар╕▓р╕Юр╕Чр╕▓р╕Зр╕Бр╕▓р╕гр╣Ар╕Бр╕йр╕Хр╕г (р╕Хр╣Ир╕нр╣Ар╕Щр╕╖р╣Ир╕нр╕З)">р╣Ар╕Чр╕Др╣Вр╕Щр╣Вр╕ер╕вр╕╡р╕Кр╕╡р╕зр╕ар╕▓р╕Юр╕Чр╕▓р╕Зр╕Бр╕▓р╕гр╣Ар╕Бр╕йр╕Хр╕г (р╕Хр╣Ир╕нр╣Ар╕Щр╕╖р╣Ир╕нр╕З)</option>
      <option value="р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╣Ар╕Бр╕йр╕Хр╕г (р╕лр╕ер╕▒р╕Бр╕кр╕╣р╕Хр╕г 4 р╕Ыр╕╡)">р╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╣Ар╕Бр╕йр╕Хр╕г (р╕лр╕ер╕▒р╕Бр╕кр╕╣р╕Хр╕г 4 р╕Ыр╕╡)</option>
    </optgroup>

    <optgroup label="р╕лр╕бр╕зр╕Фр╕нр╕╖р╣Ир╕Щ р╣Ж">
      <option value="р╕ар╕▓р╕йр╕▓р╣Бр╕ер╕░р╕кр╕▒р╕Зр╕Др╕б">р╕ар╕▓р╕йр╕▓р╣Бр╕ер╕░р╕кр╕▒р╕Зр╕Др╕б</option>
      <option value="р╕кр╕│р╕Щр╕▒р╕Бр╕Зр╕▓р╕Щр╕бр╕▓р╕Хр╕гр╕▓р╕Рр╕▓р╕Щр╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╕нр╕╕р╕Хр╕кр╕▓р╕лр╕Бр╕гр╕гр╕бр╣Бр╕ер╕░р╣Ар╕Чр╕Др╣Вр╕Щр╣Вр╕ер╕вр╕╡">
        р╕кр╕│р╕Щр╕▒р╕Бр╕Зр╕▓р╕Щр╕бр╕▓р╕Хр╕гр╕▓р╕Рр╕▓р╕Щр╕Др╕гр╕╕р╕ир╕▓р╕кр╕Хр╕гр╣Мр╕нр╕╕р╕Хр╕кр╕▓р╕лр╕Бр╕гр╕гр╕бр╣Бр╕ер╕░р╣Ар╕Чр╕Др╣Вр╕Щр╣Вр╕ер╕вр╕╡
      </option>
      <option value="р╣Ар╕Чр╕Др╣Вр╕Щр╣Вр╕ер╕вр╕╡р╕Ър╕▒р╕Ур╕Ср╕┤р╕Х (р╕Ър╕╣р╕гр╕Ур╕▓р╕Бр╕▓р╕гр╕Щр╕зр╕▒р╕Хр╕Бр╕гр╕гр╕бр╣Ар╕Юр╕╖р╣Ир╕нр╕кр╕┤р╕Щр╕Др╣Йр╕▓р╣Бр╕ер╕░р╕Ър╕гр╕┤р╕Бр╕▓р╕г)">
        р╣Ар╕Чр╕Др╣Вр╕Щр╣Вр╕ер╕вр╕╡р╕Ър╕▒р╕Ур╕Ср╕┤р╕Х (р╕Ър╕╣р╕гр╕Ур╕▓р╕Бр╕▓р╕гр╕Щр╕зр╕▒р╕Хр╕Бр╕гр╕гр╕бр╣Ар╕Юр╕╖р╣Ир╕нр╕кр╕┤р╕Щр╕Др╣Йр╕▓р╣Бр╕ер╕░р╕Ър╕гр╕┤р╕Бр╕▓р╕г)
      </option>
    </optgroup>
  </select>
</div>


        <div class="auth__field auth__field--full">
          <label class="auth__label">р╣Ар╕Ър╕нр╕гр╣Мр╣Вр╕Чр╕гр╕ир╕▒р╕Юр╕Чр╣М</label>
          <input class="auth__input" type="tel" name="phone" value="{{ old.phone if old else '' }}" required>
        </div>

        <div class="auth__field auth__field--full">
          <label class="auth__label">р╕нр╕╡р╣Ар╕бр╕е (р╕Бр╕гр╕нр╕Бр╕нр╕╡р╣Ар╕бр╕ер╕кр╕Цр╕▓р╕Ър╕▒р╕Щр╕Вр╕нр╕Зр╕Др╕╕р╕Ур╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ)</label>
          <input class="auth__input" type="email" name="email" placeholder="xxxxx@kmitl.ac.th" value="{{ old.email if old else '' }}" required>
        </div>

        <div class="auth__field auth__field--full">
          <label class="auth__label">Password</label>
          <input class="auth__input" type="password" name="password" required>
        </div>

        <div class="auth__field auth__field--full">
          <label class="auth__label">Confirm-Password</label>
          <input class="auth__input" type="password" name="confirm_password" required>
        </div>
      </div>

      <button class="auth__submit" type="submit">Register</button>
    </form>
  </div>
</section>

<!-- ===== Success Popup (Markup) ===== -->
<div id="regSuccess" class="auth-success" aria-hidden="true">
  <div class="auth-success__card" role="dialog" aria-modal="true" aria-labelledby="regSuccTitle">
    <div class="check-wrap">
      <svg class="check-svg" viewBox="0 0 64 64" aria-hidden="true">
        <circle class="check-circle" cx="32" cy="32" r="28"></circle>
        <path class="check-mark" d="M18 33 L28 43 L46 24"></path>
      </svg>
    </div>
    <h3 id="regSuccTitle" class="auth-success__title">р╕кр╕бр╕▒р╕Др╕гр╕кр╕бр╕▓р╕Кр╕┤р╕Бр╕кр╕│р╣Ар╕гр╣Зр╕И</h3>
    <p class="auth-success__desc">р╕Ър╕▒р╕Нр╕Кр╕╡р╕Вр╕нр╕Зр╕Др╕╕р╕Ур╕Цр╕╣р╕Бр╕кр╕гр╣Йр╕▓р╕Зр╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕в ЁЯОЙ</p>
    <button class="auth-success__btn" onclick="goLogin()">р╣Др╕Ыр╕лр╕Щр╣Йр╕▓ Login</button>
    <script>
      function goLogin() {
        window.location.href = "{{ url_for('auth.login_page') }}";
      }
    </script>

  </div>
</div>

<!-- ===== Success Popup (Script) ===== -->
<script>
  function openSuccess() {
    const o = document.getElementById('regSuccess');
    if (!o) return;
    o.classList.add('active');
    o.setAttribute('aria-hidden','false');
  }
  function closeSuccess() {
    const o = document.getElementById('regSuccess');
    if (!o) return;
    o.classList.remove('active');
    o.setAttribute('aria-hidden','true');
  }

  // р╣Вр╕Кр╕зр╣Мр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤р╣Ар╕бр╕╖р╣Ир╕н backend р╕кр╣Ир╕З success=True
  {% if success %}
  window.addEventListener('DOMContentLoaded', () => {
    openSuccess();
    // р╕Цр╣Йр╕▓р╕нр╕вр╕▓р╕Бр╣Гр╕лр╣Йр╣Ар╕Фр╣Йр╕Зр╣Др╕Ыр╕лр╕Щр╣Йр╕▓ login р╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤ р╕лр╕ер╕▒р╕З 2 р╕зр╕┤ р╣Гр╕лр╣Йр╣Ар╕Ыр╕┤р╕Фр╕Ър╕гр╕гр╕Чр╕▒р╕Фр╕ер╣Ир╕▓р╕Зр╕Щр╕╡р╣Й
    // setTimeout(() => { window.location.href = "{{ url_for('auth.login_page') }}"; }, 2000);
  });
  {% endif %}
</script>
{% endblock %}
