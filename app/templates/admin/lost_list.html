{% extends 'base/base_admin.html' %}
{% block title %}รายการอุปกรณ์สูญหาย/ชำรุด{% endblock %}
{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/lost_admin_v2.css') }}">

<div style="
  display: flex;
  justify-content: center;
  align-items: flex-start;  /* ✅ เปลี่ยนจาก center เป็น flex-start ให้ชิดบน */
  min-height: calc(100vh - 120px);
  padding: 60px 24px 40px; /* ✅ เว้นด้านบนแค่เล็กน้อยจาก navbar */
  box-sizing: border-box;
">

  <div style="width:95%; max-width:1100px; margin:0 auto;">
    <h2 style="text-align:center; margin-bottom:18px;">รายการแจ้งสูญหาย/ชำรุด</h2>

    <div class="lost-table-card-v2">
      <table class="lost-admin-table-v2">
        <thead>
          <tr>
            <th class="lost-col-no">#</th>
            <th class="lost-col-id">ID</th>
            <th class="lost-col-rent">รหัสเช่า</th>
            <th class="lost-col-equip">ชื่ออุปกรณ์</th>
            <th class="lost-col-detail">รายละเอียดเพิ่มเติม</th>
            <th class="lost-col-type">ประเภท</th>
            <th class="lost-col-status">สถานะ</th>
            <th class="lost-col-action">การจัดการ</th>
          </tr>
        </thead>
        <tbody>
          {% if items %}
            {% for it in items %}
            <tr>
              <td>{{ loop.index }}</td>
              <td>{{ it.item_broke_id }}</td>
              <td>{{ it.rent_id }}</td>
              <td><span class="lost-equip-name">{{ it.equipment_name if it.equipment_name else '-' }}</span></td>
              <td>
                <span class="lost-detail-text">
                  {% if it.detail %}
                    {{ it.detail[:120] }}
                    {% if it.detail|length > 120 %}...{% endif %}
                  {% else %}
                    -
                  {% endif %}
                </span>
              </td>
              <td>
                {% set t = it.type or '' %}
                {% if t.lower() in ['lost','สูญหาย'] %}
                  <span style="color:#d9534f;font-weight:700;">สูญหาย</span>
                {% elif t.lower() in ['damaged','เสียหาย'] %}
                  <span style="color:#d9534f;font-weight:700;">เสียหาย</span>
                {% else %}
                  {{ it.type }}
                {% endif %}
              </td>
              <td>
                {% if it.status == 'pending' %}
                  <span class="lost-badge lost-badge--pending">รอดำเนินการ</span>
                {% elif it.status == 'ส่งซ่อม' %}
                  <span class="lost-badge lost-badge--pending">ส่งซ่อม</span>
                {% elif it.status == 'พร้อมใช้งาน' %}
                  <span class="lost-badge lost-badge--ready">พร้อมใช้งาน</span>
                {% else %}
                  <span>{{ it.status }}</span>
                {% endif %}
              </td>
              <td class="lost-col-action">
                <a class="btn yellow" href="{{ url_for('admin.lost_report_detail', item_id=it.item_broke_id) }}">รายละเอียด</a>
              </td>
            </tr>
            {% endfor %}
          {% else %}
            <tr><td colspan="8" style="padding:16px; text-align:center;">ไม่มีรายการ</td></tr>
          {% endif %}
        </tbody>
      </table>
    </div>
  </div>
</div>

{% endblock %}

