{% extends 'base/base.html' %}
{% block title %}ประวัติการยืมของฉัน{% endblock %}
{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/my_history.css') }}">
<div class="my-history">
  <h2>ประวัติการยืมของฉัน</h2>

  {% if items|length == 0 %}
    <p class="muted">ยังไม่มีประวัติการยืม</p>
  {% else %}
    <div class="hist-grid">
      {% for it in items %}
        <div class="card">
          <div style="display:flex; gap:14px;">
            {% if it.cover_image %}
              <img class="thumb" src="{{ url_for('static', filename=it.cover_image) }}" alt="equipment">
            {% endif %}
            <div style="flex:1;">
              <div class="title">
                {{ it.equipment_name }}
                <span class="muted">({{ it.equipment_code }})</span>
              </div>
              <div class="muted">{{ it.category or '-' }}</div>
<div class="meta split">
  <div class="row">
    <strong class="label dot dot-start">เริ่ม:</strong>
    <span class="chip">วันที่: {{ it.start_date.strftime('%Y-%m-%d') }}</span>
    <span class="chip">เวลา: {{ it.start_date.strftime('%H:%M') }}</span>
  </div>

  <div class="row">
    <strong class="label dot dot-due">ครบกำหนด:</strong>
    <span class="chip">วันที่: {{ it.due_date.strftime('%Y-%m-%d') }}</span>
    <span class="chip">เวลา: {{ it.due_date.strftime('%H:%M') }}</span>
  </div>

  {% if it.return_date %}
  <div class="row">
    <strong class="label dot dot-ret">คืนจริง:</strong>
    <span class="chip">วันที่: {{ it.return_date.strftime('%Y-%m-%d') }}</span>
    <span class="chip">เวลา: {{ it.return_date.strftime('%H:%M') }}</span>
  </div>
  {% else %}
  <div class="row">
    <strong class="label dot dot-ret">คืนจริง:</strong>
    <span class="chip warn">ยังไม่คืน</span>
  </div>
  {% endif %}
</div>

            </div>
          </div>

          <div style="margin-top:10px; display:flex; align-items:center; gap:10px;">
            <span class="status-dot" style="background: {{ it.status_color or '#999' }}"></span>
            <span class="badge">{{ it.status_name }}</span>
          </div>

          {% if it.reason %}
            <p class="muted" style="margin-top:8px;">เหตุผล: {{ it.reason }}</p>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  {% endif %}
</div>
{% endblock %}
