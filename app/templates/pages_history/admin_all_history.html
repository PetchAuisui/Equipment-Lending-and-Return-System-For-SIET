{% extends 'base/base_admin.html' %}
{% block title %}‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°‡∏Ñ‡∏∑‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î{% endblock %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/admin_history.css') }}">

<div class="dashboard">
  <section class="dashboard__grid" aria-label="‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°‡∏Ñ‡∏∑‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î">

    <div class="card-wide">
      <div class="header-row">
        <h1>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°-‡∏Ñ‡∏∑‡∏ô‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h1>
      </div>

      <!-- ===== Filter Bar ===== -->
<!-- ADD-ONLY Filter Bar (‡πÑ‡∏õ‡∏ó‡∏µ‡πà OOP endpoint) -->
<div class="filter-bar">
  <form method="get" action="{{ url_for('admin_history.oop_filter') }}" class="filter-form" role="search">
    
    <!-- üîπ ‡πÇ‡∏ã‡∏ô‡∏ã‡πâ‡∏≤‡∏¢: input + label -->
    <div class="filter-group">
      <label for="identity">‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß:</label>
      <input id="identity" type="text" name="identity"
             placeholder="‡πÄ‡∏ä‡πà‡∏ô 65070xxxx ‡∏´‡∏£‡∏∑‡∏≠ EMP123"
             value="{{ q_identity or '' }}">
      
      <label for="start">‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label>
      <input id="start" type="date" name="start" value="{{ q_start or '' }}">
      
      <label for="end">‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label>
      <input id="end" type="date" name="end" value="{{ q_end or '' }}">
    </div>

    <!-- üîπ ‡πÇ‡∏ã‡∏ô‡∏Ç‡∏ß‡∏≤: ‡∏õ‡∏∏‡πà‡∏° -->
    <div class="filter-actions">
      <button type="submit" class="btn btn-filter">‡∏Å‡∏£‡∏≠‡∏á</button>
      {% if q_start or q_end or q_identity %}
        <a href="{{ url_for('admin_history.oop_index') }}" class="btn btn-clear">‡∏•‡πâ‡∏≤‡∏á</a>
      {% endif %}
    </div>

  </form>
</div>




      <table class="table table-striped" style="width:100%; border-collapse: collapse;">
  <thead>
  <tr style="background:#f3f3f3;">
    <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</th>
    <th>‡∏£‡∏´‡∏±‡∏™</th>
    <th>‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</th>
    <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡∏°</th>
    <th>‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏∑‡∏ô</th>
    <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏∑‡∏ô</th>
    <th>‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏∑‡∏ô</th>          <!-- üÜï -->
    <th>‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á</th>   <!-- üÜï -->
    <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
  </tr>
</thead>
<tbody>
  {% for item in items %}
  <tr>
    <td>{{ item.user_name }}</td>
    <td>{{ item.student_id or item.employee_id or '-' }}</td>
    <td>{{ item.equipment_name }}</td>
    <td>{{ item.start_date.strftime('%d/%m/%Y') if item.start_date else '-' }}</td>
    <td>{{ item.due_date.strftime('%d/%m/%Y') if item.due_date else '-' }}</td>
    <td>{{ item.return_date.strftime('%d/%m/%Y') if item.return_date else '-' }}</td>
    <td>{{ item.receiver_name or '-' }}</td>        <!-- üÜï -->
    <td>{{ item.instructor_name or '-' }}</td>     <!-- üÜï -->
    <td>
      <span class="status-chip"
            style="color:{{ item.status_color or '#333' }}">{{ item.status_name or '-' }}</span>
    </td>
  </tr>
  {% else %}
  <tr><td colspan="9" class="text-center">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°</td></tr>
  {% endfor %}
</tbody>

      </table>
    </div>

  </section>
</div>
{% endblock %}
